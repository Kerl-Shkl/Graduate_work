%! TEX root = ../main.tex

\section{Отказ от классических функций}

Реализуемый метод защиты подразумевает проверку контрольной суммы в различных
местах работы программы. В классическом подходе подобные задачи решаются
вынесением повторяющегося участка кода в отдельную функцию. Но конкретно в нашем
случае такой подход имеет ряд недостатков. 

Функция представляет собой участок памяти с кодом, в которой передается
управление при вызове данной функции. То есть, если программа в двух разных
местах вызовет одну и ту же функцию, то процессор в обоих случаях передаст
управление одному и тому же участку кода.  Злоумышленнику будет достаточно
изменить код в одном месте программы (в функции, осуществляющей защиту), чтобы
обойти все проверки. 

Б\'{о}льшую безопасность предоставляют встроенные (inline) функции. При вызове
встроенной функции компилятор подставляет код данной функции на место каждого
вызова. Вставка происходит только в том случае, если анализ затрат и преимуществ
компилятора показывает, что это целесообразно. Другими словами, компилятор может
игнорировать ключевое слово \verb!inline!. В компиляторе MSVC есть директива
\verb!__forceinline!, которая позволяет сделать функцию встраиваемой независимо
от анализа компилятора.

В данной работе защита будет представлена в виде макроса, а не встроенной
функции, так как это предоставит еще более широкие возможности по сокрытию кода,
о которых написано в третьей главе.
